<!--?xml version="1.0" encoding="utf-8" ?--><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="../../../../_rhdefault.css"></head><body id="reconfiguring-enterprise-vault-using-set-evdatabasedetail" class="" lang="en_US"><div class="breadcrumbs"><div><div><a href="">Day-to-day administration</a></div><div><a href="">Using SQL Always On availability groups</a></div><div><a href="">Implementing SQL Always On availability groups</a></div><div><a href="contents/day-to-day-administration/using-sql-always-on-availability-groups/implementing-sql-always-on-availability-groups/reconfiguring-enterprise-vaul-4daa015159">Reconfiguring Enterprise Vault using Set-EVDatabaseDetail</a></div></div></div><h1 class="title">Reconfiguring Enterprise Vault using Set-EVDatabaseDetail</h1><div class="tcx-empty-element"></div><div id="reconfiguring-enterprise-vault-using-set-evdatabasedetail-1" class=""><h1 class="title">Reconfiguring Enterprise Vault using Set-EVDatabaseDetail</h1><div class=""><div class="p"><div><div><b class="ph b display-inline">Set-EVDatabaseDetail</b><span> updates SQL server connection details for Enterprise Vault databases.</span></div></div></div><div class="p"><div><div><span>For any Enterprise Vault databases that you have added to an availability group, you must run </span><b class="ph b display-inline">Set-EVDatabaseDetail</b><span> to replace the SQL instances they used before you added them to the availability group, with a listener name. You can do this for all Enterprise Vault databases in a single operation, or do it selectively.</span></div></div></div><div class="p"><div><div><span>For example, you can use the following procedure to reconfigure all Enterprise Vault's databases to use the availability group listener, "evaglistener".</span></div></div></div><div class="p"><div><div><span>To reconfigure all Enterprise Vault's databases</span></div></div></div><ul class="ul"><li class="li"><div class="p"><div><div><span>In the Enterprise Vault Management Shell, run the following command:</span></div></div></div></li></ul><div class="p"><div><div><b class="ph b display-inline">Get-EVDatabaseDetail | Set-EVDatabaseDetail -ServerName evaglistener</b></div></div></div><div class="p"><div><div><span>This uses the </span><b class="ph b display-inline">Get-EVDatabaseDetail</b><span> to get all the Enterprise Vault databases, and pipe them into </span><b class="ph b display-inline">Set-EVDatabaseDetail</b><span> , which reconfigures each to use the listener, "evaglistener".</span></div></div></div><div class="p"><div><div><span>Note that </span><b class="ph b display-inline">Set-EVDatabaseDetail</b><span> produces no output when it is successful.</span></div></div></div><div class="p"><div><div><span>You can also use </span><b class="ph b display-inline">Get-EVDatabaseDetail</b><span> and </span><b class="ph b display-inline">Set-EVDatabaseDetail</b><span> to reconfigure Enterprise Vault selectively. For example, you could use the following procedure in a more complex environment, to reconfigure just the databases that currently use a specified SQL instance.</span></div></div></div><div class="p"><div><div><span>To reconfigure Enterprise Vault databases that use a specified listener</span></div></div></div><ul class="ul"><li class="li"><div class="p"><div><div><span>In the Enterprise Vault Management Shell, run the following command:</span></div></div></div></li></ul><div class="p"><div><div><b class="ph b display-inline">Get-EVDatabaseDetail | where {$_.SQLInstanceName -eq 'evsql'} | Set-EVDatabaseDetail -ServerName evaglistener</b></div></div></div><div class="p"><div><div><span>This uses the </span><b class="ph b display-inline">Get-EVDatabaseDetail</b><span> to get all the Enterprise Vault databases that currently use SQL instance "evsql", and pipe them into </span><b class="ph b display-inline">Set-EVDatabaseDetail</b><span> , which reconfigures each to use the listener, "evaglistener".</span></div></div></div><div class="p"><div><div><span>To configure AAG listener with custom ports</span></div></div></div><ol class="ol"><li class="li"><div class="p"><div><div><span>In the Enterprise Vault Management Shell, run the following command to reconfigure all databases to the same AG listener on the same SQL server to use port 1095:</span></div></div></div></li></ol><div class="p"><div><div><b class="ph b display-inline">Get-EVDatabaseDetail | Set-EVDatabaseDetail -ServerName evaglistener,1095</b></div></div></div><ol class="ol"><li class="li"><div class="p"><div><div><span>To reconfigure a specific database, such as the </span><i class="ph i display-inline">EnterpriseVaultDirectory</i><span> database to use port 1095:</span></div></div></div></li></ol><div class="p"><div><div><b class="ph b display-inline">Get-EVDatabaseDetail | where {$_.DBName -eq 'EnterpriseVaultDirectory'} | Set-EVDatabaseDetail -ServerName evaglistener,1095</b></div></div></div></div></div></body></html>